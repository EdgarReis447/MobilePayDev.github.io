"use strict";(self.webpackChunkmobile_pay_merchant_payments_documentation=self.webpackChunkmobile_pay_merchant_payments_documentation||[]).push([[6998],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),d=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=d(e.components);return n.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=d(a),h=r,g=c["".concat(p,".").concat(h)]||c[h]||s[h]||l;return a?n.createElement(g,i(i({ref:t},m),{},{components:a})):n.createElement(g,i({ref:t},m))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var d=2;d<l;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},95191:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const l={},i="Appendix",o={unversionedId:"online/appendix",id:"online/appendix",title:"Appendix",description:"Error codes",source:"@site/docs/online/appendix.md",sourceDirName:"online",slug:"/online/appendix",permalink:"/MobilePay-Payments-API/docs/online/appendix",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"onlineSidebar",previous:{title:"MobilePay Checkout best practice",permalink:"/MobilePay-Payments-API/docs/online/features/checkout-best-practice"}},p={},d=[{value:"Error codes",id:"error-codes",level:2},{value:"Allowed currencies",id:"allowed-currencies",level:2},{value:"Allowed card types",id:"allowed-card-types",level:2},{value:"Embedded Flow",id:"embedded-flow",level:2},{value:"Embed the website in an IFrame",id:"embed-the-website-in-an-iframe",level:3},{value:"Add an Event Listener to the parent page of the IFrame",id:"add-an-event-listener-to-the-parent-page-of-the-iframe",level:3},{value:"Manually engaging the App from the parent page",id:"manually-engaging-the-app-from-the-parent-page",level:3}],m={toc:d};function s(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"appendix"},"Appendix"),(0,r.kt)("h2",{id:"error-codes"},"Error codes"),(0,r.kt)("p",null,"The following will describe the error codes thrown and in which cases they can occur."),(0,r.kt)("p",null,"The error format for status code 409 will be the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "code": "2020",\n    "message": "Some description",\n    "correlationId": "8d72ece4-1b0b-464b-98d9-6bbb02199dc8"\n}\n')),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Code"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Endpoint(s)"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2000"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Merchant doesn't exist")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2010"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The merchant isn't created by you")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2020"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The merchant is deleted")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2030"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Allowed card types are not set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2040"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"One or more of the allowed card types are invalid")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2050"),(0,r.kt)("td",{parentName:"tr",align:"left"},"POST /payments"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Currency code is invalid")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2100"),(0,r.kt)("td",{parentName:"tr",align:"left"},"PUT payments/{paymentId:guid}/invalidate"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Can't invalidate payment with completed authorization attempt")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2101"),(0,r.kt)("td",{parentName:"tr",align:"left"},"PUT payments/{paymentId:guid}/invalidate"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Can't invalidate payment - the authorization attempt has not yet been patched with success or failure. Try again later.")))),(0,r.kt)("h2",{id:"allowed-currencies"},"Allowed currencies"),(0,r.kt)("p",null,"Currencies must be specified according to the ISO-4217 standard. Either using the alphabetic or numeric version.\nAllowed currencies are:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Alphabetic code"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Numeric code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Danish kroner"),(0,r.kt)("td",{parentName:"tr",align:"left"},"DKK"),(0,r.kt)("td",{parentName:"tr",align:"left"},"208")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Euro"),(0,r.kt)("td",{parentName:"tr",align:"left"},"EUR"),(0,r.kt)("td",{parentName:"tr",align:"left"},"978")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Norwegian kroner"),(0,r.kt)("td",{parentName:"tr",align:"left"},"NOK"),(0,r.kt)("td",{parentName:"tr",align:"left"},"578")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Swedish kroner"),(0,r.kt)("td",{parentName:"tr",align:"left"},"SEK"),(0,r.kt)("td",{parentName:"tr",align:"left"},"752")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"United States dollar"),(0,r.kt)("td",{parentName:"tr",align:"left"},"USD"),(0,r.kt)("td",{parentName:"tr",align:"left"},"840")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Pound sterling"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\xa0GBP"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\xa0826")))),(0,r.kt)("h2",{id:"allowed-card-types"},"Allowed card types"),(0,r.kt)("p",null,"The following card types are allowed:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Card name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Code"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Visa electron"),(0,r.kt)("td",{parentName:"tr",align:"left"},"ELEC-DEBIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Mastercard credit"),(0,r.kt)("td",{parentName:"tr",align:"left"},"MC-CREDIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Mastercard debit"),(0,r.kt)("td",{parentName:"tr",align:"left"},"MC-DEBIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Maestro"),(0,r.kt)("td",{parentName:"tr",align:"left"},"MTRO-DEBIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Visa credit"),(0,r.kt)("td",{parentName:"tr",align:"left"},"VISA-CREDIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Visa debit"),(0,r.kt)("td",{parentName:"tr",align:"left"},"VISA-DEBIT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Dankort"),(0,r.kt)("td",{parentName:"tr",align:"left"},"DANKORT")))),(0,r.kt)("h2",{id:"embedded-flow"},"Embedded Flow"),(0,r.kt)("p",null,"Web shops and Payment Service Providers (PSPs) may embed the MobilePay landing\npage inside their own website by nesting the page in an IFrame and then\nlisten to the events emitted from the IFrame."),(0,r.kt)("p",null,"Embedding is especially relevant for 'dual-flow' use; where the user starts by\nentering his or her phone number in a browser and then continues the flow in the\napp to accept the payment."),(0,r.kt)("p",null,"When the user has accepted the payment (swiped) in the app, the landing page\nwill by default redirect to the url provided when the payment was created."),(0,r.kt)("p",null,"Build your logic on the parent page, listen for the events published by the\nIFrame and redirect the user to the right page based on the returned data,\ne.g. depending on whether the user cancelled or completed the payment."),(0,r.kt)("h3",{id:"embed-the-website-in-an-iframe"},"Embed the website in an IFrame"),(0,r.kt)("p",null,'Add an "IFrame" to the html source and set the IFrame "src" property to the URL\nreturned from the payment link creation endpoint.'),(0,r.kt)("p",null,"On mobile devices it is expected that the MobilePay flow visually covers the\nwhole screen (simple header and footer is acceptable)."),(0,r.kt)("p",null,"Be aware that you might want to show the user different content if the user is inside\nan IFrame or not. If you support both IFrame and full window, we recommend that\nyou have a neutral return page without visual content."),(0,r.kt)("p",null,"The width should be 375px."),(0,r.kt)("p",null,"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},' <IFrame\n   scrolling="no"\n   src="https://products.mobilepay.dk/remote-website/index.html?page=request&id=83554a83-cd90-4ac9-bf6e-39357c21dca5&version=2"\n   style="width: 375px; height: 480px; border: 0;" >\n</IFrame>\n')),(0,r.kt)("h3",{id:"add-an-event-listener-to-the-parent-page-of-the-iframe"},"Add an Event Listener to the parent page of the IFrame"),(0,r.kt)("p",null,"The parent page can listen for events by adding an event listener to the IFrame."),(0,r.kt)("p",null,"Before the IFrame redirects, it will post a message to all registered event\nhandlers, giving any parent page the alternative option of handling the page\nnavigation instead, for example in the case where you want the parent page to\nchange too."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'window.addEventListener(\n    "message",\n    function(event) {\n        if (event.data && event.data.startsWith("mobilepay:")){\n            // Do your logic\n            // Continue purchase processing\n            alert(event.data);\n        }\n    },\n    false);\n')),(0,r.kt)("p",null,"When the user terminates the payment flow, the published event will look like as\nfollows. The code and matching description indicate how the flow was terminated,\ni.e. either because the payment was completed, rejected, cancelled by the user\nor because the timer expired."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"mobilepay:rc={code}&message={description}\n\n// example\nmobilepay:rc=0&message=completed\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Response Code"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"0"),(0,r.kt)("td",{parentName:"tr",align:"left"},"completed")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"rejected")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"3"),(0,r.kt)("td",{parentName:"tr",align:"left"},"expired")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"4"),(0,r.kt)("td",{parentName:"tr",align:"left"},"cancelled")))),(0,r.kt)("h3",{id:"manually-engaging-the-app-from-the-parent-page"},"Manually engaging the App from the parent page"),(0,r.kt)("p",null,"On mobile devices the app is not guaranteed to engage when the website is nested\ninside an IFrame."),(0,r.kt)("p",null,"To preserve the expected behavior of engaging the app on mobile devices, the\nparent of the IFrame may try to engage the app with the following javascript\nsnippet that use a custom url registered for both Android and iOS.\nThis custom url (redirectToMobilePayAppUrl) is part of the response received, when a payment is initiated."),(0,r.kt)("p",null,"You should still display the landing page inside the IFrame in case the app is\nnot installed or the user navigates back to your page."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'function tryToOpenMobilePayApp(paymentId) {\n   try {\n      window.open("_redirectToMobilePayAppUrl", "_parent");\n   } catch {\n      // window.open should just fail without throwing aside from logging an\n      // error to console.\n      //\n      // This catch is strictly for good measure to avoid any incidents\n      // in legacy or future browser settings.\n   }\n}\n')))}s.isMDXComponent=!0}}]);